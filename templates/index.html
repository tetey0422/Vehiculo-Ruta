{% extends 'base.html' %}

{% block title %}Dashboard - VconRuta{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="welcome-header" style="text-align: center; margin-bottom: 40px;">
        <h1 style="color: #333; margin-bottom: 10px;">📊 Panel de Control</h1>
        <p style="color: #666; font-size: 1.1rem;">Gestiona tu flota de vehículos y rutas de transporte</p>
    </div>
    
    <!-- Estadísticas principales -->
    <div class="stats-grid">
        <div class="stat-card vehicles">
            <span class="stat-number">{{ total_vehiculos }}</span>
            <span class="stat-label">Total Vehículos</span>
        </div>
        
        <div class="stat-card available">
            <span class="stat-number">{{ vehiculos_disponibles }}</span>
            <span class="stat-label">Vehículos Disponibles</span>
        </div>
        
        <div class="stat-card routes">
            <span class="stat-number">{{ total_rutas }}</span>
            <span class="stat-label">Total Rutas</span>
        </div>
        
        <div class="stat-card active">
            <span class="stat-number">{{ rutas_activas }}</span>
            <span class="stat-label">Rutas Activas</span>
        </div>
    </div>
    
    <!-- Acciones rápidas -->
    <div class="quick-actions" style="text-align: center; margin: 40px 0;">
        <h3 style="margin-bottom: 25px; color: #333;">🚀 Acciones Rápidas</h3>
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
            <a href="{{ url_for('nuevo_vehiculo') }}" class="btn btn-success">
                ➕ Agregar Vehículo
            </a>
            <a href="{{ url_for('nueva_ruta') }}" class="btn btn-primary">
                🗺️ Nueva Ruta
            </a>
            <a href="{{ url_for('listar_vehiculos') }}" class="btn btn-info">
                📋 Ver Vehículos
            </a>
            <a href="{{ url_for('listar_rutas') }}" class="btn btn-warning">
                📍 Ver Rutas
            </a>
        </div>
    </div>
    
    <!-- Herramientas de sistema -->
    <div class="system-tools" style="margin-top: 40px; padding: 25px; background: white; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h3 style="margin-bottom: 20px; color: #333; text-align: center;">🔧 Herramientas del Sistema</h3>
        
        <div style="text-align: center;">
            <form method="POST" action="{{ url_for('validar_estados') }}" style="display: inline-block; margin-right: 15px;">
                <button type="submit" class="btn btn-warning" onclick="return confirm('¿Desea validar y corregir los estados de vehículos y rutas?');">
                    🔄 Validar Estados
                </button>
            </form>
            
            <a href="{{ url_for('test') }}" class="btn btn-info">
                🧪 Test de Conexión
            </a>
        </div>
        
        <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 0.9rem; color: #666;">
            <p><strong>💡 Información:</strong></p>
            <ul style="margin: 10px 0; padding-left: 20px;">
                <li><strong>Validar Estados:</strong> Corrige inconsistencias entre estados de vehículos y rutas</li>
                <li><strong>Test de Conexión:</strong> Verifica que la aplicación esté funcionando correctamente</li>
            </ul>
        </div>
    </div>
    
    <!-- Resumen del sistema -->
    <div class="system-summary" style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; text-align: center;">
        <h3 style="margin-bottom: 15px;">📈 Resumen del Sistema</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div>
                <strong>Eficiencia de Flota</strong><br>
                <span style="font-size: 1.2rem;">{{ "%.1f"|format((vehiculos_disponibles / total_vehiculos * 100) if total_vehiculos > 0 else 0) }}%</span><br>
                <small>Vehículos disponibles</small>
            </div>
            <div>
                <strong>Actividad de Rutas</strong><br>
                <span style="font-size: 1.2rem;">{{ "%.1f"|format((rutas_activas / total_rutas * 100) if total_rutas > 0 else 0) }}%</span><br>
                <small>Rutas en curso</small>
            </div>
            <div>
                <strong>Estado General</strong><br>
                <span style="font-size: 1.2rem;">
                    {% if total_vehiculos > 0 and total_rutas > 0 %}
                        ✅ Operativo
                    {% else %}
                        ⚠️ Configurando
                    {% endif %}
                </span><br>
                <small>Sistema</small>
            </div>
        </div>
    </div>
</div>
{% endblock %}